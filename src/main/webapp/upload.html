<!DOCTYPE html>
<html>
	<head>
	<title>Mediashare - upload</title>
	<meta charset='utf-8'>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap-theme.min.css">
	<link rel="stylesheet" href="styles/all.css">
	<link rel="stylesheet" href="styles/upload.css">
		<script type="text/javascript">
			function fileSelected() {
				var file = document.getElementById('fileToUpload').files[0];
				if(file){
					var fileSize = 0;
					if (file.size>1024*1024){
						fileSize = (Math.round(file.size * 100 / (1024 * 1024)) / 100).toString() + 'Méga';
					}else if(file.size>1024){
						fileSize = (Math.round(file.size * 100 / 1024) / 100).toString() + 'Kilo';
					}else{ 
						fileSize = (Math.round(file.size * 100) / 100 ).toString();
					}
					fileSize += 'Octets';
					document.getElementById('fileName').innerHTML = 'Nom : ' + file.name;
					document.getElementById('fileSize').innerHTML = 'Taille : ' + fileSize;
					document.getElementById('fileType').innerHTML = 'Type : ' + file.type;
				}
			}

			function uploadFile() {
				var fd = new FormData();
				fd.append("fileToUpload", document.getElementById('fileToUpload').files[0]);
				var xhr = new XMLHttpRequest();
				xhr.upload.addEventListener("progress", uploadProgress, false);
				xhr.addEventListener("load", uploadComplete, false);
				xhr.addEventListener("error", uploadFailed, false);
				xhr.addEventListener("abort", uploadCanceled, false);
				xhr.open("POST", "upload");
				xhr.send(fd);
			}

			function uploadProgress(evt) {
				if(evt.lengthComputable){
					var percentComplete = Math.round(evt.loaded * 100 / evt.total);
					document.getElementById('progressNumber').innerHTML = percentComplete.toString() + '/100%';
				}else{
					document.getElementById('progressNumber').innerHTML = 'unable to compute';
				}
			}

			function uploadComplete(evt) {
				/* appelé lors de la réponse du serveur */
				alert("fuuuuuuuuuuuuuu\n"+evt.target.responseText);
			}

			function uploadFailed(evt) {
				alert("There was an error attempting to upload the file.");
			}

			function uploadCanceled(evt) {
				alert("The upload has been canceled by the user or the browser dropped the connection.");
			}
		</script>
	</head>
	<body>
		<nav class="navbar navbar-default barre">
			<div class="container-fluid">	
				<div class="navbar-header">
					<a href="murGeneral.html"> <img src="images/banniere.png" alt="Banniere du site" style="width:100px"> </a>
					<a> &nbsp; &nbsp;  </a>
				</div>			
				<div id="navbar" class="navbar-collapse collapse">
					<ul class="nav navbar-nav">
						<li><a href="murGeneral.html">Mur General</a></li>
						<li><a href="recherche.html">Recherche</a></li>
						<li><a href="profileViewer.html">Profil</a></li>
						<li><a href="logout.html">Déconnexion</a></li>

					</ul>
					<ul class="nav navbar-nav navbar-right">
							<li><a href="contact.html">Contact</a></li>
					</ul>
				</div><!--/.nav-collapse -->
			</div><!--/.container-fluid -->
		</nav><br />
		<center>
			<h1><b>Mediashare</b></h1>
			<form method="POST" action="upload" enctype="multipart/form-data" >
				<div class="row">
					<h3><label for="fileToUpload">Choisissez un fichier à uploader</label></h3><br />
					<input type="file" name="fileToUpload" id="fileToUpload" onchange="fileSelected();"/><br />
					<div id="fileName"></div>
					<div id="fileSize"></div>
					<div id="fileType"></div><br />
					<input type="text" name="description" id="description" />
				</div>
				<br />
				<div class="row">
					<input type="submit" class="btn btn-primary" value="Upload" name="upload" id="upload" />
				</div>
				<div id="progressNumber"></div>
			</form>
		</center>
	</body>
</html>
